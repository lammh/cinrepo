<?php /*
This File was developed by Stefan Warnat <vtiger@stefanwarnat.de>

It belongs to the Workflow Designer and must not be distrubuted without the complete extension
*/
namespace Workflow\Preset;${"\x47\x4cOB\x41L\x53"}["it\x6d\x61vw\x76\x79m"]="ta\x78";${"\x47\x4c\x4f\x42A\x4c\x53"}["\x6d\x76\x72\x65\x63\x74\x6e\x67p\x66"]="\x66\x69e\x6c\x64Ind\x65\x78";${"GL\x4fB\x41L\x53"}["\x63js\x78\x72r\x63\x65"]="\x61\x64d\x69t\x69\x6f\x6e\x61l";${"G\x4cOBAL\x53"}["\x62\x6cr\x6au\x75u\x6b\x70\x62"]="\x61\x64d\x69\x74i\x6fn\x61\x6c\x50\x72\x6f\x64\x75\x63\x74\x46\x69e\x6c\x64\x73";${"\x47\x4cOB\x41\x4cS"}["em\x76\x70xg\x78\x75\x62u"]="\x6b\x65y";${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x75mt\x73\x6d\x6e\x72o\x69v"]="a\x54\x61x";${"GLO\x42\x41\x4cS"}["v\x70\x6ci\x74\x76ux"]="av\x61\x69\x6c\x54\x61\x78\x65\x73";${"G\x4c\x4f\x42A\x4c\x53"}["\x65\x78ev\x6dti\x64n"]="\x63\x72m\x50\x72\x6fdu\x63t";${"\x47L\x4f\x42\x41\x4cS"}["\x62\x65rax\x72\x72"]="pa\x72\x74\x73";${"G\x4c\x4f\x42AL\x53"}["a\x62\x69iq\x76ys"]="\x70\x72\x6f\x64\x75\x63t\x69d";${"GL\x4f\x42\x41L\x53"}["\x73\x6at\x66m\x68hr\x6c"]="\x76\x61l\x75e";${"\x47\x4cO\x42\x41L\x53"}["\x6e\x6d\x71s\x61\x6c\x79"]="pr\x6f\x64u\x63\x74\x43\x61c\x68e";${"\x47\x4c\x4fB\x41\x4c\x53"}["\x64j\x6d\x76\x76\x73\x67\x64\x76dv"]="\x64a\x74\x61\x4f\x62\x6a";${"\x47\x4c\x4f\x42A\x4c\x53"}["\x6c\x62l\x74v\x66\x7a"]="\x70\x72od\x75c\x74";${"G\x4c\x4f\x42\x41\x4c\x53"}["n\x68\x73b\x6fir\x75\x77"]="d\x61\x74a";${"\x47L\x4f\x42\x41\x4cS"}["\x63\x67\x66mjwwpi\x70"]="\x61d\x62";use\Workflow\VtUtils;use\Workflow\VTEntity;class ProductChooser extends\Workflow\Preset{protected$_JSFiles=array('ProductChooser.js');protected$_fromFields=null;public function beforeSave($data){${"\x47L\x4fB\x41\x4c\x53"}["zkh\x6cph\x6ey"]="\x64\x61\x74\x61";return${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x7ak\x68\x6cp\x68\x6e\x79"]};}public function beforeGetTaskform($data){$pplkpxdfnevl="\x76\x69e\x77\x65\x72";$iuekfubh="da\x74\x61";${${"\x47\x4cOB\x41\x4c\x53"}["\x63g\x66m\x6a\x77\x77p\x69\x70"]}=\PearDatabase::getInstance();list(${${"\x47L\x4f\x42\x41\x4cS"}["n\x68s\x62\x6f\x69r\x75\x77"]},${$pplkpxdfnevl})=${$iuekfubh};${"G\x4c\x4f\x42A\x4cS"}["\x6b\x71\x76\x6dn\x73\x71\x63\x71"]="\x70\x72od\x75\x63tC\x61\x63\x68e";$viewer->assign("\x61vail\x54\x61\x78es",getAllTaxes("ava\x69la\x62\x6c\x65"));$viewer->assign("a\x76ai\x6c\x43urrenc\x79",getAllCurrencies());${${"G\x4c\x4fB\x41\x4c\x53"}["\x6bqv\x6d\x6es\x71\x63q"]}=array();foreach(${${"G\x4c\x4f\x42\x41\x4c\x53"}["\x6eh\x73\x62\x6f\x69r\x75\x77"]}[$this->field]as${${"G\x4cOB\x41\x4c\x53"}["lb\x6ct\x76fz"]}){if(!empty(${${"\x47\x4c\x4f\x42A\x4cS"}["\x6c\x62\x6c\x74v\x66z"]}["\x70ro\x64ucti\x64"])){${"G\x4c\x4f\x42A\x4c\x53"}["\x62\x63f\x6ega\x72cj\x64\x79"]="\x70\x72\x6f\x64\x75\x63\x74";${${"G\x4cOB\x41\x4cS"}["d\x6a\x6d\x76\x76\x73\x67d\x76\x64\x76"]}=\Vtiger_Record_Model::getInstanceById(${${"\x47LO\x42A\x4c\x53"}["\x6c\x62\x6ct\x76f\x7a"]}["pro\x64uc\x74i\x64"]);$kkoeiyxt="p\x72\x6f\x64\x75c\x74\x43\x61\x63\x68\x65";${$kkoeiyxt}[${${"\x47\x4c\x4f\x42A\x4c\x53"}["bc\x66\x6e\x67\x61\x72cjd\x79"]}["\x70ro\x64\x75\x63\x74\x69\x64"]]=array("\x64at\x61"=>$dataObj->getData(),"tax"=>$dataObj->getTaxes(),"\x6cab\x65l"=>\Vtiger_Functions::getCRMRecordLabel(${${"\x47\x4c\x4fB\x41\x4c\x53"}["\x6c\x62l\x74\x76\x66z"]}["p\x72o\x64ucti\x64"]),);}}$viewer->assign("pr\x6f\x64uc\x74\x43\x61\x63h\x65",${${"\x47L\x4f\x42\x41L\x53"}["n\x6d\x71\x73\x61\x6c\x79"]});$viewer->assign("s\x65lecte\x64Pr\x6fducts",${${"\x47\x4c\x4fB\x41\x4c\x53"}["\x6e\x68\x73\x62o\x69\x72\x75w"]}[$this->field]);$viewer->assign("a\x64di\x74\x69\x6f\x6e\x61\x6c\x50r\x6fd\x75ct\x46\x69\x65\x6cd\x73",\Workflow\VTInventoryEntity::getAdditionalProductFields());$this->addInlineJS("");$viewer->assign("\x50\x72\x6fd\x75ct\x43hooser",$viewer->fetch("\x6d\x6fdul\x65s/\x53\x65ttin\x67\x73/\x57or\x6bflow\x32/helpers/\x50\x72o\x64uc\x74C\x68o\x6fser\x2e\x74\x70l"));}public function addProducts2Entity($products,\Workflow\VTEntity$context,\Workflow\VTEntity$newObj){$ntuvkohe="\x6e\x65\x77\x4f\x62\x6a";$byrhbpbrk="a\x76\x61il\x54\x61x\x65s";${"\x47\x4c\x4fB\x41L\x53"}["\x77\x68\x6f\x72\x65y"]="in\x64\x65x";$ffgqftdius="\x70\x72o\x64\x75\x63ts";${$byrhbpbrk}=getAllTaxes("\x61vai\x6c\x61bl\x65");foreach(${$ffgqftdius} as${${"\x47L\x4f\x42\x41\x4cS"}["\x77\x68\x6f\x72\x65y"]}=>${${"\x47\x4c\x4fBA\x4c\x53"}["\x73\x6atfmh\x68\x72\x6c"]}){${"\x47\x4c\x4fBA\x4c\x53"}["\x69i\x64\x6e\x65jx\x65"]="pr\x6f\x64\x75c\x74\x69\x64";${"\x47\x4cO\x42\x41\x4c\x53"}["\x6dk\x68\x73\x6c\x73\x79\x6d\x70\x71\x78"]="v\x61l\x75\x65";${"G\x4c\x4f\x42A\x4c\x53"}["d\x77\x68\x64\x74\x6f\x7a\x76\x79\x6e\x71w"]="a\x64d\x69\x74\x69\x6fna\x6c\x50\x72\x6f\x64u\x63t\x46i\x65\x6c\x64\x73";$kruolocojg="a\x54a\x78";$hovdgrthnuug="\x70\x72o\x64u\x63t\x69d";$qtcncloye="\x76\x61l\x75\x65";if(!empty(${${"\x47L\x4fB\x41\x4c\x53"}["\x6d\x6b\x68\x73\x6c\x73\x79m\x70\x71x"]}["\x70ro\x64uc\x74i\x64_i\x6e\x64\x69\x76i\x64u\x61\x6c"])){$wyriktxohly="v\x61\x6c\x75e";${"\x47L\x4f\x42\x41\x4c\x53"}["\x73g\x74\x63yh\x78ie"]="co\x6e\x74ex\x74";${${"\x47\x4c\x4f\x42ALS"}["\x61\x62\x69\x69q\x76\x79\x73"]}=\Workflow\VTTemplate::parse(${$wyriktxohly}["\x70\x72\x6fd\x75\x63\x74id_in\x64ivi\x64\x75al"],${${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x73g\x74\x63\x79\x68\x78\x69\x65"]});}else{$upfwkclmyw="\x76a\x6cue";${${"\x47\x4cO\x42\x41\x4cS"}["\x61\x62\x69iqv\x79\x73"]}=${$upfwkclmyw}["p\x72o\x64\x75c\x74\x69\x64"];}$ftfrgn="\x61\x64\x64i\x74\x69\x6f\x6e\x61\x6c";$rjivvcng="v\x61lue";$txyfsrjjlt="\x6b\x65\x79";if(strpos(${${"G\x4cO\x42A\x4cS"}["\x61\x62\x69\x69\x71v\x79\x73"]},"\x78")!==false){$iicydljc="\x70\x72o\x64\x75\x63\x74i\x64";${${"\x47\x4c\x4fB\x41L\x53"}["b\x65\x72\x61\x78rr"]}=explode("x",${${"G\x4c\x4f\x42\x41\x4c\x53"}["a\x62i\x69\x71v\x79\x73"]});${$iicydljc}=${${"\x47\x4c\x4f\x42\x41L\x53"}["\x62\x65\x72\x61\x78\x72\x72"]}[1];}${${"\x47L\x4f\x42A\x4c\x53"}["ex\x65\x76\x6d\x74\x69dn"]}=\CRMEntity::getInstance("P\x72\x6fdu\x63\x74s");$crmProduct->id=${${"\x47L\x4f\x42AL\x53"}["a\x62iiqv\x79\x73"]};${"\x47\x4c\x4f\x42\x41\x4c\x53"}["\x73\x6a\x73e\x72d\x64rpv\x71"]="\x74\x65m\x70l\x61t\x65";${"\x47L\x4fBAL\x53"}["\x79\x78\x6b\x6f\x71g\x66\x64\x70p\x61"]="\x74a\x78";$tzdqzqwys="\x76\x61\x6c\x75e";$crmProduct->retrieve_entity_info(${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x69i\x64n\x65\x6a\x78\x65"]},"P\x72oduc\x74s");${"G\x4c\x4fBALS"}["ww\x6bmvd\x71\x71\x6b\x63"]="\x76\x61\x6c\x75\x65";${"\x47\x4cO\x42\x41\x4cS"}["k\x65fwi\x79\x6d\x72\x73"]="\x6e\x6f\x74\x55\x73\x65\x64";$context->setEnvironment("p\x72\x6f\x64\x75ct",$crmProduct->column_fields);${${"G\x4c\x4fB\x41LS"}["\x79x\x6bo\x71\x67f\x64p\x70a"]}=array();foreach(${${"G\x4c\x4f\x42\x41\x4c\x53"}["\x76\x70\x6c\x69\x74\x76ux"]} as${$kruolocojg}){$aupvkbaasytu="a\x54ax";if(${${"\x47\x4c\x4f\x42AL\x53"}["s\x6a\x74\x66\x6d\x68\x68\x72\x6c"]}["ta\x78".${$aupvkbaasytu}["t\x61\x78\x69d"]."_\x65n\x61\x62\x6c\x65"]==1){${"\x47\x4c\x4f\x42\x41\x4cS"}["ogk\x67\x62\x70\x6f\x63\x73"]="\x76a\x6c\x75e";${"\x47L\x4f\x42\x41\x4c\x53"}["\x69\x6ar\x79\x63bkk\x72"]="\x61\x54ax";$mkhbocmhrmpk="\x74a\x78";${"G\x4c\x4f\x42\x41\x4c\x53"}["\x64\x74\x67\x68\x72\x73"]="\x63\x6fn\x74\x65\x78\x74";${$mkhbocmhrmpk}[${${"G\x4cO\x42\x41L\x53"}["\x75\x6dt\x73m\x6e\x72o\x69\x76"]}["ta\x78\x69d"]]=\Workflow\VTTemplate::parse(${${"G\x4c\x4fB\x41L\x53"}["o\x67\x6b\x67\x62\x70o\x63s"]}["tax".${${"\x47L\x4f\x42\x41LS"}["\x69\x6a\x72yc\x62\x6b\x6br"]}["t\x61\x78i\x64"]],${${"G\x4c\x4fBA\x4c\x53"}["\x64t\x67\x68\x72\x73"]});}}foreach(${${"\x47\x4cO\x42AL\x53"}["w\x77\x6b\x6dv\x64q\x71kc"]} as${$txyfsrjjlt}=>${${"G\x4cOB\x41LS"}["sj\x73e\x72\x64\x64\x72\x70vq"]}){${"\x47\x4c\x4f\x42A\x4c\x53"}["\x78\x6cr\x6e\x6d\x66c\x76\x70v"]="\x63o\x6e\x74\x65\x78\x74";${"\x47L\x4f\x42A\x4c\x53"}["\x7a\x68h\x61\x72\x76\x63\x78"]="\x76\x61\x6cu\x65";${"GLO\x42A\x4c\x53"}["\x71\x68c\x75\x77\x6a\x67\x6c"]="te\x6d\x70\x6c\x61te";${${"G\x4cOB\x41\x4c\x53"}["\x7a\x68\x68a\x72vc\x78"]}[${${"\x47\x4c\x4f\x42A\x4c\x53"}["em\x76\x70xg\x78\x75\x62u"]}]=\Workflow\VTTemplate::parse(${${"GL\x4f\x42\x41L\x53"}["\x71\x68\x63u\x77\x6ag\x6c"]},${${"\x47\x4c\x4f\x42\x41LS"}["\x78\x6c\x72\x6e\x6d\x66cv\x70\x76"]});}${${"G\x4c\x4f\x42A\x4c\x53"}["b\x6c\x72j\x75\x75\x75kp\x62"]}=\Workflow\VTInventoryEntity::getAdditionalProductFields();${${"\x47\x4c\x4f\x42A\x4c\x53"}["c\x6as\x78\x72\x72\x63\x65"]}=array();foreach(${${"\x47\x4c\x4f\x42A\x4c\x53"}["\x64w\x68d\x74oz\x76\x79\x6eq\x77"]} as${${"\x47\x4c\x4f\x42\x41\x4cS"}["mv\x72\x65\x63t\x6eg\x70\x66"]}=>${${"\x47L\x4f\x42\x41L\x53"}["ke\x66wi\x79\x6dr\x73"]}){$fvxbkhyucq="\x66\x69\x65\x6c\x64I\x6e\x64\x65\x78";${"GL\x4f\x42\x41LS"}["wqqxw\x65\x77\x64\x6f"]="v\x61\x6c\x75\x65";${"\x47\x4c\x4f\x42\x41L\x53"}["\x73\x63\x77\x6ey\x6bwdcx\x73"]="\x61d\x64\x69\x74\x69\x6f\x6eal";$gjgvfrgxj="\x66i\x65\x6cd\x49\x6e\x64\x65\x78";${${"\x47\x4c\x4fB\x41LS"}["\x73\x63\x77ny\x6b\x77\x64\x63\x78\x73"]}[${$gjgvfrgxj}]=${${"\x47\x4c\x4f\x42\x41L\x53"}["w\x71qx\x77e\x77\x64\x6f"]}[${$fvxbkhyucq}];}$newObj->addProduct(${$hovdgrthnuug},${$tzdqzqwys}["d\x65scri\x70ti\x6f\x6e"],${${"\x47\x4c\x4f\x42\x41\x4cS"}["\x73j\x74\x66\x6d\x68\x68\x72\x6c"]}["\x63o\x6dmen\x74"],${${"\x47\x4cO\x42\x41L\x53"}["\x73\x6a\x74f\x6d\x68h\x72l"]}["\x71uantit\x79"],${${"G\x4c\x4fB\x41\x4c\x53"}["sj\x74\x66\x6dh\x68\x72l"]}["u\x6eit\x70r\x69c\x65"],(${$qtcncloye}["d\x69\x73co\x75nt\x5f\x6dode"]=="p\x65r\x63\x65\x6e\x74\x61\x67e"?${${"\x47\x4c\x4fB\x41\x4c\x53"}["sj\x74\x66\x6d\x68h\x72\x6c"]}["d\x69s\x63\x6f\x75n\x74\x5fv\x61\x6c\x75\x65"]:0),(${${"G\x4cOB\x41\x4c\x53"}["\x73\x6at\x66mh\x68\x72\x6c"]}["d\x69\x73\x63oun\x74_mo\x64e"]=="a\x6doun\x74"?${$rjivvcng}["d\x69\x73c\x6f\x75nt\x5f\x76al\x75\x65"]:0),${${"\x47\x4cO\x42ALS"}["\x69t\x6d\x61v\x77\x76\x79\x6d"]},${$ftfrgn});}return${$ntuvkohe};}}
?>